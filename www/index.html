<!DOCTYPE html>

<html>

<head>

    <title>Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css" />
    <script src="themes/jquery-1.11.1.min.js"></script>
    <script src="themes/jquery.mobile-1.4.5.min.js"></script>
</head>

<body>

    <div data-role="page" id="page1">

        <div data-role="header">
            <h1 id="showDate">DD/MM/YYYY</h1>
        </div>

        <div data-role="content">

            <fieldset data-role="controlgroup"></fieldset>
            <legend><h3>To do list</h3></legend>

            <div id="taskList">

                <input type="checkbox" name="" id="" value="">
                <label for="">
                    <p></p>
                </label>

            </div>

            </fieldset>

            <input type="text" name="taskAdd" id="taskAdd" value="">
            <button id="addBtn">Add</button>

        </div><!-- /content -->

        <div data-role="footer">

        </div><!-- /footer -->


    </div>


    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>

    <script type="text/javascript">

        let taskTxt = [];
        let taskStatus = [];

        $(function () {
            console.log("ready!");

            if (window.localStorage.getItem("TASK_TXT") == undefined) { 
                //undisplay everything bc have no data in storage
                $("#taskList").html("");
            } else {
                //Get the data from storage
                
                let text = window.localStorage.getItem("TASK_TXT");
                let status = window.localStorage.getItem("TASK_STAT");

                let textArr = text.split(":");
                let statusArr = status.split(":");

                console.log(textArr);



            }

            $("#addBtn").click(function () {
                console.log("task added");

                //Add task to taskTxt set
                taskTxt.shift($("#taskAdd").val());

                //set complete status to incomplete (represent by 0)
                taskStatus.shift(0);

                //Save taskTxt to local storage
                let text = "";
                taskTxt.forEach(function(item, index, array){
                    text = text + ":" + item;
                })
                window.localStorage.setItem("TASK_TXT", text);

                //Save taskStatus to local storage
                text = "";
                taskStatus.forEach(function(item, index, array){
                    text = text + ":" + item;
                })
                window.localStorage.setItem("TASK_STAT", text);
                
                //reload page
                //location.reload();

                //clear text box
                //$("#taskAdd").val("");

            });

            $("input[type=checkbox]").click(function () {
                console.log("checked ", this.checked);

                if (this.checked) {
                    userPref.add(this.value);
                    $("label p").css("text-decoration", "line-through");
                } else {
                    userPref.delete(this.value);
                    $("label p").css("text-decoration", "none");

                }


            });


            
        });


    </script>


</body>

</html>